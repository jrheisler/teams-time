import { writeFileSync } from 'node:fs';

const width = 800;
const height = 400;

function project([lon, lat]) {
  const x = ((lon + 180) / 360) * width;
  const y = ((90 - lat) / 180) * height;
  return [Number(x.toFixed(2)), Number(y.toFixed(2))];
}

function pathFromPoints(points) {
  const projected = points.map(project);
  const commands = projected.map(([x, y], index) => `${index === 0 ? 'M' : 'L'}${x} ${y}`);
  commands.push('Z');
  return commands.join(' ');
}

const shapes = [
  {
    id: 'eurasia-africa',
    points: [
      [-9.5, 36.0],
      [-6.0, 42.0],
      [-5.0, 43.6],
      [-2.0, 43.5],
      [1.5, 43.0],
      [3.5, 43.4],
      [6.0, 45.0],
      [8.4, 44.4],
      [9.5, 41.5],
      [12.5, 41.9],
      [13.5, 45.5],
      [14.5, 46.3],
      [16.6, 46.5],
      [18.8, 45.8],
      [20.0, 44.2],
      [21.0, 43.3],
      [23.0, 44.0],
      [24.5, 45.3],
      [27.5, 45.5],
      [29.0, 46.5],
      [31.0, 47.3],
      [34.5, 46.5],
      [38.0, 45.4],
      [40.5, 43.5],
      [42.5, 41.5],
      [45.0, 39.5],
      [45.5, 37.5],
      [47.0, 39.0],
      [49.0, 41.0],
      [51.0, 42.0],
      [54.0, 41.5],
      [56.0, 43.5],
      [57.5, 44.5],
      [59.0, 46.0],
      [61.0, 49.0],
      [64.0, 51.5],
      [66.0, 54.0],
      [70.0, 55.0],
      [72.0, 54.0],
      [75.0, 55.0],
      [78.0, 56.0],
      [80.0, 56.0],
      [82.0, 57.0],
      [84.5, 58.0],
      [88.0, 60.0],
      [90.0, 62.0],
      [93.5, 63.0],
      [96.0, 64.0],
      [101.0, 65.0],
      [106.0, 67.5],
      [111.0, 68.0],
      [115.0, 68.5],
      [120.0, 70.0],
      [126.0, 71.0],
      [130.0, 72.5],
      [136.0, 72.5],
      [140.0, 71.0],
      [146.0, 70.0],
      [150.0, 69.0],
      [154.0, 67.0],
      [160.0, 67.0],
      [164.0, 66.0],
      [168.0, 65.0],
      [170.0, 62.0],
      [172.0, 60.0],
      [173.0, 58.0],
      [174.0, 55.0],
      [176.0, 52.0],
      [179.0, 49.0],
      [178.0, 46.0],
      [174.0, 44.0],
      [170.0, 43.0],
      [164.0, 43.5],
      [160.0, 46.0],
      [154.0, 47.0],
      [148.0, 46.0],
      [142.0, 45.0],
      [135.0, 43.0],
      [130.0, 40.0],
      [126.0, 37.0],
      [125.0, 34.0],
      [121.0, 32.0],
      [120.0, 29.0],
      [118.0, 26.0],
      [116.0, 22.0],
      [112.0, 18.0],
      [108.0, 17.0],
      [104.0, 15.0],
      [100.0, 13.0],
      [97.0, 10.0],
      [102.0, 7.0],
      [106.0, 6.0],
      [110.0, 6.0],
      [115.0, 4.0],
      [120.0, 4.0],
      [125.0, 2.0],
      [128.0, 0.0],
      [130.0, -3.0],
      [132.0, -6.0],
      [134.0, -8.0],
      [137.0, -12.0],
      [141.0, -14.0],
      [146.0, -18.0],
      [149.0, -21.0],
      [146.0, -24.0],
      [141.0, -25.0],
      [138.0, -25.0],
      [134.0, -22.0],
      [130.0, -20.0],
      [126.0, -20.0],
      [120.0, -22.0],
      [114.0, -20.0],
      [110.0, -16.0],
      [106.0, -12.0],
      [104.0, -7.0],
      [101.0, -4.0],
      [96.0, -2.0],
      [94.0, 3.0],
      [90.0, 8.0],
      [86.0, 12.0],
      [82.0, 15.0],
      [78.0, 18.0],
      [74.0, 21.0],
      [70.0, 22.0],
      [66.0, 24.0],
      [63.0, 27.0],
      [60.0, 30.0],
      [58.0, 34.0],
      [55.0, 36.0],
      [51.0, 34.0],
      [48.0, 30.0],
      [45.0, 28.0],
      [42.0, 33.0],
      [40.0, 36.0],
      [37.0, 36.0],
      [34.0, 32.0],
      [30.0, 32.0],
      [27.0, 33.0],
      [24.0, 32.0],
      [22.0, 31.0],
      [20.0, 32.0],
      [19.0, 30.0],
      [20.0, 27.0],
      [19.0, 25.0],
      [17.0, 23.0],
      [15.0, 19.0],
      [14.0, 16.0],
      [13.0, 13.0],
      [12.0, 10.0],
      [10.0, 8.0],
      [8.0, 5.0],
      [6.0, 4.0],
      [4.0, 5.0],
      [2.0, 5.0],
      [0.0, 6.0],
      [-2.0, 7.0],
      [-4.0, 9.0],
      [-6.0, 10.0],
      [-9.0, 9.0],
      [-12.0, 10.0],
      [-14.0, 12.0],
      [-17.0, 14.0],
      [-18.0, 17.0],
      [-17.0, 20.0],
      [-16.0, 22.0],
      [-15.0, 24.0],
      [-15.0, 27.0],
      [-15.0, 30.0],
      [-12.0, 28.0],
      [-9.5, 36.0]
    ]
  },
  {
    id: 'north-america',
    points: [
      [-168.0, 72.0],
      [-165.0, 65.0],
      [-158.0, 63.0],
      [-150.0, 60.0],
      [-142.0, 59.0],
      [-135.0, 56.0],
      [-128.0, 54.0],
      [-125.0, 50.0],
      [-123.0, 48.0],
      [-122.0, 45.0],
      [-123.0, 41.5],
      [-124.0, 38.0],
      [-123.0, 36.0],
      [-119.0, 34.0],
      [-117.0, 32.5],
      [-114.0, 32.5],
      [-112.0, 31.5],
      [-109.0, 31.0],
      [-106.0, 31.0],
      [-103.0, 29.0],
      [-100.0, 28.0],
      [-97.0, 25.0],
      [-94.0, 23.0],
      [-90.0, 21.0],
      [-87.0, 20.0],
      [-85.0, 21.0],
      [-84.0, 23.5],
      [-82.0, 25.0],
      [-80.0, 26.0],
      [-78.0, 28.0],
      [-76.0, 30.0],
      [-74.0, 31.5],
      [-72.0, 32.5],
      [-70.0, 40.0],
      [-69.0, 43.0],
      [-67.0, 45.0],
      [-66.0, 47.0],
      [-67.0, 49.0],
      [-69.0, 51.0],
      [-72.0, 53.0],
      [-75.0, 55.0],
      [-80.0, 58.0],
      [-85.0, 59.0],
      [-90.0, 59.0],
      [-95.0, 57.0],
      [-100.0, 56.0],
      [-110.0, 60.0],
      [-120.0, 65.0],
      [-130.0, 70.0],
      [-140.0, 72.0],
      [-150.0, 72.0],
      [-160.0, 73.0],
      [-168.0, 72.0]
    ]
  },
  {
    id: 'greenland',
    points: [
      [-52.0, 83.0],
      [-46.0, 82.0],
      [-42.0, 80.0],
      [-37.0, 78.0],
      [-35.0, 75.0],
      [-36.0, 73.0],
      [-39.0, 72.0],
      [-44.0, 72.0],
      [-48.0, 74.0],
      [-50.0, 76.0],
      [-53.0, 78.0],
      [-55.0, 80.0],
      [-54.0, 82.0],
      [-52.0, 83.0]
    ]
  },
  {
    id: 'south-america',
    points: [
      [-81.0, 12.0],
      [-79.0, 8.0],
      [-77.0, 4.0],
      [-76.0, 1.0],
      [-75.0, -4.0],
      [-77.0, -8.0],
      [-80.0, -12.0],
      [-81.0, -18.0],
      [-79.0, -23.0],
      [-75.0, -27.0],
      [-70.0, -30.0],
      [-67.0, -36.0],
      [-65.0, -40.0],
      [-63.0, -45.0],
      [-62.0, -50.0],
      [-60.0, -52.0],
      [-58.0, -53.0],
      [-56.0, -52.0],
      [-54.0, -50.0],
      [-52.0, -46.0],
      [-50.0, -40.0],
      [-48.0, -36.0],
      [-44.0, -30.0],
      [-42.0, -22.0],
      [-41.0, -14.0],
      [-43.0, -6.0],
      [-46.0, -2.0],
      [-50.0, 2.0],
      [-54.0, 5.0],
      [-58.0, 6.0],
      [-62.0, 6.0],
      [-66.0, 5.0],
      [-70.0, 5.0],
      [-74.0, 8.0],
      [-78.0, 10.0],
      [-81.0, 12.0]
    ]
  },
  {
    id: 'australia',
    points: [
      [113.0, -22.0],
      [116.0, -25.0],
      [121.0, -26.0],
      [126.0, -25.0],
      [132.0, -25.0],
      [137.0, -27.0],
      [140.0, -32.0],
      [146.0, -34.0],
      [151.0, -33.0],
      [153.0, -29.0],
      [152.0, -24.0],
      [148.0, -20.0],
      [143.0, -18.0],
      [136.0, -16.0],
      [130.0, -15.0],
      [124.0, -16.0],
      [120.0, -18.0],
      [116.0, -20.0],
      [113.0, -22.0]
    ]
  },
  {
    id: 'new-zealand',
    points: [
      [166.0, -33.0],
      [170.0, -37.0],
      [173.0, -42.0],
      [170.0, -45.0],
      [167.0, -44.0],
      [165.0, -40.0],
      [166.0, -33.0]
    ]
  },
  {
    id: 'japan',
    points: [
      [130.0, 33.0],
      [132.0, 35.0],
      [135.0, 37.0],
      [138.0, 38.0],
      [141.0, 39.0],
      [143.0, 42.0],
      [142.0, 44.0],
      [139.0, 45.0],
      [136.0, 43.0],
      [134.0, 40.0],
      [132.0, 38.0],
      [130.0, 35.0],
      [130.0, 33.0]
    ]
  },
  {
    id: 'iceland',
    points: [
      [-25.0, 66.0],
      [-22.0, 67.0],
      [-18.0, 66.5],
      [-16.0, 64.0],
      [-20.0, 63.0],
      [-23.0, 63.5],
      [-25.0, 66.0]
    ]
  },
  {
    id: 'british-isles',
    points: [
      [-8.0, 54.0],
      [-6.0, 58.0],
      [-3.0, 59.0],
      [0.0, 58.0],
      [1.5, 56.0],
      [0.5, 54.0],
      [-1.0, 51.0],
      [-4.0, 50.0],
      [-6.0, 51.0],
      [-8.0, 54.0]
    ]
  },
  {
    id: 'madagascar',
    points: [
      [46.0, -12.0],
      [49.0, -15.0],
      [50.0, -18.0],
      [49.0, -21.0],
      [47.0, -23.0],
      [44.0, -21.0],
      [43.0, -17.0],
      [44.0, -13.0],
      [46.0, -12.0]
    ]
  },
  {
    id: 'southeast-asia-islands',
    points: [
      [96.0, 6.0],
      [100.0, 6.0],
      [104.0, 4.0],
      [108.0, 5.0],
      [111.0, 7.0],
      [115.0, 6.0],
      [118.0, 4.0],
      [118.0, 1.0],
      [116.0, -2.0],
      [112.0, -4.0],
      [108.0, -3.0],
      [104.0, -2.0],
      [100.0, 0.0],
      [98.0, 2.0],
      [96.0, 6.0]
    ]
  },
  {
    id: 'new-guinea',
    points: [
      [130.0, -1.0],
      [134.0, -2.0],
      [138.0, -2.5],
      [143.0, -5.0],
      [148.0, -6.0],
      [151.0, -4.0],
      [150.0, -1.0],
      [146.0, 1.0],
      [140.0, 1.5],
      [135.0, 1.5],
      [131.0, 0.5],
      [130.0, -1.0]
    ]
  },
  {
    id: 'antarctica',
    points: [
      [-180.0, -60.0],
      [-160.0, -68.0],
      [-120.0, -70.0],
      [-60.0, -72.0],
      [-20.0, -74.0],
      [20.0, -74.0],
      [60.0, -72.0],
      [100.0, -68.0],
      [140.0, -66.0],
      [180.0, -64.0],
      [180.0, -80.0],
      [-180.0, -80.0]
    ]
  }
];

const svgPaths = shapes.map(({ id, points }) => ({
  id,
  d: pathFromPoints(points)
}));

const svgContent = `<?xml version="1.0" encoding="UTF-8"?>\n` +
  `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${width} ${height}" role="img" aria-label="World map basemap">\n` +
  `  <defs>\n` +
  `    <linearGradient id="worldWater" x1="0" y1="0" x2="0" y2="1">\n` +
  `      <stop offset="0" stop-color="#d7edff" />\n` +
  `      <stop offset="1" stop-color="#b8dcff" />\n` +
  `    </linearGradient>\n` +
  `    <linearGradient id="worldLand" x1="0" y1="0" x2="0" y2="1">\n` +
  `      <stop offset="0" stop-color="#cbd5f5" />\n` +
  `      <stop offset="1" stop-color="#9fb7e1" />\n` +
  `    </linearGradient>\n` +
  `  </defs>\n` +
  `  <rect width="${width}" height="${height}" fill="url(#worldWater)" />\n` +
  `  <g fill="url(#worldLand)" stroke="#5b7bb2" stroke-width="1.6" stroke-linejoin="round">\n` +
  svgPaths.map(({ id, d }) => `    <path id="${id}" d="${d}" />`).join('\n') +
  '\n  </g>\n' +
  '</svg>\n';

writeFileSync(new URL('../assets/world-detailed.svg', import.meta.url), svgContent, 'utf8');
